@* Reusable game grid component that renders level state *@

<div class="game-grid">
    @for (int row = 0; row < GridSize; row++)
    {
        @for (int col = 0; col < GridSize; col++)
        {
            var currentRow = row;
            var currentCol = col;
            var cellType = GetCellType(currentRow, currentCol);
            <div class="grid-cell @cellType"></div>
        }
    }
</div>

@code {
    private const int GridSize = 20;

    [Parameter]
    public List<Position> Snake { get; set; } = new();

    [Parameter]
    public List<Position> Apples { get; set; } = new();

    [Parameter]
    public Position? Portal { get; set; }

    [Parameter]
    public List<Position> GroundBlocks { get; set; } = new();

    [Parameter]
    public List<Position> PushableBlocks { get; set; } = new();

    [Parameter]
    public List<Position> Bombs { get; set; } = new();

    private string GetCellType(int row, int col)
    {
        var pos = new Position(row, col);

        // Check if snake (highest priority for rendering)
        for (int i = 0; i < Snake.Count; i++)
        {
            if (Snake[i].Equals(pos))
            {
                return i == 0 ? "snake-head" : "snake-body";
            }
        }

        // Check if pushable block (can cover bombs)
        if (PushableBlocks.Contains(pos))
            return "pushable-block";

        // Check if portal
        if (Portal != null && pos.Equals(Portal))
            return "portal";

        // Check if apple
        if (Apples.Contains(pos))
            return "apple";

        // Check if ground block
        if (GroundBlocks.Contains(pos))
            return "ground-block";

        // Check if bomb
        if (Bombs.Contains(pos))
            return "bomb";

        return "";
    }
}

